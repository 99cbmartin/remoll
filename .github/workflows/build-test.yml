name: Build Test

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: eic/setup-cvmfs@main
      - uses: eic/setup-spack@main
        with:
          environment: eic
      - name: Build
        run: |
          source ${SPACK_ROOT}/share/spack/setup-env.sh
          spack load root
          spack load geant4
          mkdir build
          cmake -B build -DGeant4_DIR=`spack location -i geant4`/lib*/Geant*/
          make -C build install
      - name: Test
        run: |
          build/remoll macros/runexample.mac
